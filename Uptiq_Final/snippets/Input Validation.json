{
  "_id": "a7c3b695-5251-4793-92dd-d68cc1ad8a48",
  "aiPersonaId": "5cefb5e0-1663-431f-91de-146273e752a4",
  "code": "const main = () => {\n    // Tax Compliance Input Validator (Card Format)\n    let transactions = input?.data?.transactions || [];\n    transactions = Array.isArray(transactions) ? transactions : [];\n    \n    // Validate and transform transactions\n    const validatedCards = transactions.map((tx, index) => {\n        const isValid = (\n            tx.asset && \n            typeof tx.asset === 'string' &&\n            /^\\d{4}-\\d{2}-\\d{2}$/.test(tx.sale_date) &&\n            /^\\d{4}-\\d{2}-\\d{2}$/.test(tx.purchase_date)\n        );\n        \n        return {\n            label: `${tx.asset.toUpperCase()}`,\n            value: `tx_${index}`,\n            subTitle: `Sell: ${tx.sale_date} | Buy: ${tx.purchase_date}`,\n            meta: {\n                originalIndex: index,\n                isValid: isValid,\n                validationErrors: isValid ? [] : [\n                    ...(!tx.asset ? [\"Missing asset symbol\"] : []),\n                    ...(!/^\\d{4}-\\d{2}-\\d{2}$/.test(tx.sale_date) ? [\"Invalid sale date\"] : []),\n                    ...(!/^\\d{4}-\\d{2}-\\d{2}$/.test(tx.purchase_date) ? [\"Invalid purchase date\"] : [])\n                ]\n            }\n        };\n    });\n\n    return {\n        options: validatedCards,\n        type: \"cardSelect\",\n        subTitleField: \"subTitle\",\n        validationSummary: {\n            validCount: validatedCards.filter(card => card.meta.isValid).length,\n            invalidCount: validatedCards.filter(card => !card.meta.isValid).length\n        }\n    };\n};\n\nmain();\n\n/*\n * Example Output:\n * {\n *   \"options\": [\n *     {\n *       \"label\": \"AAPL\",\n *       \"value\": \"tx_0\",\n *       \"subTitle\": \"Sell: 2024-11-30 | Buy: 2024-05-15\",\n *       \"meta\": {\n *         \"originalIndex\": 0,\n *         \"isValid\": true,\n *         \"validationErrors\": []\n *       }\n *     },\n *     {\n *       \"label\": \"TSLA\",\n *       \"value\": \"tx_1\",\n *       \"subTitle\": \"Sell: 2024-12-01 | Buy: invalid-date\",\n *       \"meta\": {\n *         \"originalIndex\": 1,\n *         \"isValid\": false,\n *         \"validationErrors\": [\"Invalid purchase date\"]\n *       }\n *     }\n *   ],\n *   \"type\": \"cardSelect\",\n *   \"subTitleField\": \"subTitle\",\n *   \"validationSummary\": {\n *     \"validCount\": 1,\n *     \"invalidCount\": 1\n *   }\n * }\n */",
  "name": "Input Validation",
  "status": "Active"
}